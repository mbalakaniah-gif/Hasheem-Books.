<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hasheem Suppliers</title>

<!-- jsPDF + AutoTable -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.29/jspdf.plugin.autotable.min.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
  padding: 15px;
}
.header {
  background: #2c3e50;
  color: white;
  padding: 15px;
  border-radius: 10px;
  text-align: center;
}
.logo-circle {
  width: 90px;
  height: 90px;
  border-radius: 50%;
  background: white;
  margin: auto;
  display: flex;
  align-items: center;
  justify-content: center;
}
.logo-circle img {
  width: 70px;
}
h1 {
  margin: 10px 0 0;
}
.form-box {
  background: white;
  padding: 15px;
  border-radius: 10px;
  margin-top: 15px;
}
label {
  font-weight: bold;
}
input, select {
  width: 100%;
  padding: 10px;
  margin-top: 5px;
}
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 15px;
  background: white;
}
th, td {
  border: 1px solid #ccc;
  padding: 8px;
  text-align: center;
}
th {
  background: #34495e;
  color: white;
}
button {
  padding: 12px;
  width: 100%;
  margin-top: 15px;
  border: none;
  background: #3498db;
  color: white;
  font-size: 16px;
  border-radius: 8px;
}
.add-btn {
  background: #27ae60;
}
</style>
</head>

<body>

<div class="header">
  <div class="logo-circle">
    <img src="1.png" alt="Logo">
  </div>
  <h1>HASHEEM SUPPLIERS</h1>
  <div>Lilongwe Main Market, Shop 47</div>
</div>

<div class="form-box">
  <label>Document Type</label>
  <select id="docType">
    <option>Receipt</option>
    <option>Quotation</option>
  </select>

  <label>Customer Name</label>
  <input type="text" id="customer">
</div>

<table id="itemTable">
  <thead>
    <tr>
      <th>Item</th>
      <th>Qty</th>
      <th>Price (MWK)</th>
      <th>Amount (MWK)</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<button class="add-btn" onclick="addRow()">âž• Add Item</button>
<button onclick="generatePDF()">ðŸ“„ Generate PDF</button>

<script>
function addRow() {
  const row = document.createElement("tr");
  row.innerHTML = `
    <td><input></td>
    <td><input type="number" value="1"></td>
    <td><input type="number" value="0"></td>
    <td>0.00</td>
  `;
  document.querySelector("#itemTable tbody").appendChild(row);

  row.querySelectorAll("input").forEach(() => updateAmounts());
}

function updateAmounts() {
  document.querySelectorAll("#itemTable tbody tr").forEach(row => {
    const qty = Number(row.children[1].children[0].value);
    const price = Number(row.children[2].children[0].value);
    row.children[3].innerText = (qty * price).toFixed(2);
  });
}

document.addEventListener("input", updateAmounts);

function generatePDF() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  const docType = document.getElementById("docType").value;
  const customer = document.getElementById("customer").value || "N/A";
  const docNo = "HS-" + Math.floor(100000 + Math.random() * 900000);

  doc.setFont("helvetica","bold");
  doc.setFontSize(20);
  doc.text("HASHEEM SUPPLIERS",105,15,{align:"center"});

  doc.setFontSize(12);
  doc.text(docType.toUpperCase(),105,25,{align:"center"});

  doc.setFont("helvetica","normal");
  doc.text(`No: ${docNo}`,14,35);
  doc.text(`Name: ${customer}`,14,42);
  doc.text("Phone: 0999 954 649",14,52);
  doc.text("Email: hasheemsuppliers@gmail.com",14,58);

  let body = [];
  let total = 0;

  document.querySelectorAll("#itemTable tbody tr").forEach(row => {
    const item = row.children[0].children[0].value;
    const qty = Number(row.children[1].children[0].value);
    const price = Number(row.children[2].children[0].value);
    const amount = qty * price;
    total += amount;

    body.push([
      item,
      qty,
      `MWK ${price.toFixed(2)}`,
      `MWK ${amount.toFixed(2)}`
    ]);
  });

  body.push([
    { content: "TOTAL", colSpan: 3, styles: { halign:"right", fontStyle:"bold" } },
    { content: `MWK ${total.toFixed(2)}`, styles: { fontStyle:"bold" } }
  ]);

  doc.autoTable({
    startY: 65,
    head: [["Item","Qty","Price (MWK)","Amount (MWK)"]],
    body: body,
    theme: "grid",
    headStyles: { fillColor:[44,62,80] }
  });

  doc.save(`${docType}_${docNo}.pdf`);
}

addRow();
</script>

</body>
</html>
